package DG2D

type BarcentricNode struct {
	L1, L2, L3, W float64
}

func WilliamsShunnJameson(P int) (pts []Point) {
	pts, _ = WilliamsShunnJamesonWithWeights(P)
	return
}

func WilliamsShunnJamesonWithWeights(P int) (pts []Point, wts []float64) {
	var BaryCoords = [][]BarcentricNode{
		{
			{L1: 0.333333333333333, L2: 0.333333333333333, L3: 0.333333333333333, W: 1.000000000000000},
		},
		{
			{L1: 0.666666666666667, L2: 0.166666666666667, L3: 0.166666666666667, W: 0.333333333333333},
			{L1: 0.166666666666667, L2: 0.666666666666667, L3: 0.166666666666667, W: 0.333333333333333},
			{L1: 0.166666666666667, L2: 0.166666666666667, L3: 0.666666666666667, W: 0.333333333333333},
		},
		{
			{L1: 0.816847572980440, L2: 0.091576213509780, L3: 0.091576213509780, W: 0.109951743655333},
			{L1: 0.091576213509780, L2: 0.816847572980440, L3: 0.091576213509780, W: 0.109951743655333},
			{L1: 0.091576213509780, L2: 0.091576213509780, L3: 0.816847572980440, W: 0.109951743655333},
			{L1: 0.445948490915964, L2: 0.445948490915964, L3: 0.108103018168071, W: 0.223381589678000},
			{L1: 0.445948490915964, L2: 0.108103018168071, L3: 0.445948490915964, W: 0.223381589678000},
			{L1: 0.108103018168071, L2: 0.445948490915964, L3: 0.445948490915964, W: 0.223381589678000},
		},
		{
			{L1: 0.888871894660413, L2: 0.055564052669793, L3: 0.055564052669793, W: 0.041955512996649},
			{L1: 0.055564052669793, L2: 0.888871894660413, L3: 0.055564052669793, W: 0.041955512996649},
			{L1: 0.055564052669793, L2: 0.055564052669793, L3: 0.888871894660413, W: 0.041955512996649},
			{L1: 0.295533711735893, L2: 0.634210747745723, L3: 0.070255540518384, W: 0.112098412070887},
			{L1: 0.295533711735893, L2: 0.070255540518384, L3: 0.634210747745723, W: 0.112098412070887},
			{L1: 0.070255540518384, L2: 0.295533711735893, L3: 0.634210747745723, W: 0.112098412070887},
			{L1: 0.634210747745723, L2: 0.295533711735893, L3: 0.070255540518384, W: 0.112098412070887},
			{L1: 0.634210747745723, L2: 0.070255540518384, L3: 0.295533711735893, W: 0.112098412070887},
			{L1: 0.070255540518384, L2: 0.634210747745723, L3: 0.295533711735893, W: 0.112098412070887},
			{L1: 0.333333333333333, L2: 0.333333333333333, L3: 0.333333333333333, W: 0.201542988584730},
		},
		{
			{L1: 0.928258244608533, L2: 0.035870877695734, L3: 0.035870877695734, W: 0.017915455012303},
			{L1: 0.035870877695734, L2: 0.928258244608533, L3: 0.035870877695734, W: 0.017915455012303},
			{L1: 0.035870877695734, L2: 0.035870877695734, L3: 0.928258244608533, W: 0.017915455012303},
			{L1: 0.516541208464066, L2: 0.241729395767967, L3: 0.241729395767967, W: 0.127712195881265},
			{L1: 0.241729395767967, L2: 0.516541208464066, L3: 0.241729395767967, W: 0.127712195881265},
			{L1: 0.241729395767967, L2: 0.241729395767967, L3: 0.516541208464066, W: 0.127712195881265},
			{L1: 0.474308787777079, L2: 0.474308787777079, L3: 0.051382424445843, W: 0.076206062385535},
			{L1: 0.474308787777079, L2: 0.051382424445843, L3: 0.474308787777079, W: 0.076206062385535},
			{L1: 0.051382424445843, L2: 0.474308787777079, L3: 0.474308787777079, W: 0.076206062385535},
			{L1: 0.201503881881800, L2: 0.751183631106484, L3: 0.047312487011716, W: 0.055749810027115},
			{L1: 0.201503881881800, L2: 0.047312487011716, L3: 0.751183631106484, W: 0.055749810027115},
			{L1: 0.047312487011716, L2: 0.201503881881800, L3: 0.751183631106484, W: 0.055749810027115},
			{L1: 0.751183631106484, L2: 0.201503881881800, L3: 0.047312487011716, W: 0.055749810027115},
			{L1: 0.751183631106484, L2: 0.047312487011716, L3: 0.201503881881800, W: 0.055749810027115},
			{L1: 0.047312487011716, L2: 0.751183631106484, L3: 0.201503881881800, W: 0.055749810027115},
		},
		{
			{L1: 0.943774095634672, L2: 0.028112952182664, L3: 0.028112952182664, W: 0.010359374696538},
			{L1: 0.028112952182664, L2: 0.943774095634672, L3: 0.028112952182664, W: 0.010359374696538},
			{L1: 0.028112952182664, L2: 0.028112952182664, L3: 0.943774095634672, W: 0.010359374696538},
			{L1: 0.645721803061365, L2: 0.177139098469317, L3: 0.177139098469317, W: 0.075394884326738},
			{L1: 0.177139098469317, L2: 0.645721803061365, L3: 0.177139098469317, W: 0.075394884326738},
			{L1: 0.177139098469317, L2: 0.177139098469317, L3: 0.645721803061365, W: 0.075394884326738},
			{L1: 0.405508595867433, L2: 0.405508595867433, L3: 0.188982808265134, W: 0.097547802373242},
			{L1: 0.405508595867433, L2: 0.188982808265134, L3: 0.405508595867433, W: 0.097547802373242},
			{L1: 0.188982808265134, L2: 0.405508595867433, L3: 0.405508595867433, W: 0.097547802373242},
			{L1: 0.148565812270887, L2: 0.817900980028499, L3: 0.033533207700614, W: 0.028969269372473},
			{L1: 0.148565812270887, L2: 0.033533207700614, L3: 0.817900980028499, W: 0.028969269372473},
			{L1: 0.033533207700614, L2: 0.148565812270887, L3: 0.817900980028499, W: 0.028969269372473},
			{L1: 0.817900980028499, L2: 0.148565812270887, L3: 0.033533207700614, W: 0.028969269372473},
			{L1: 0.817900980028499, L2: 0.033533207700614, L3: 0.148565812270887, W: 0.028969269372473},
			{L1: 0.033533207700614, L2: 0.817900980028499, L3: 0.148565812270887, W: 0.028969269372473},
			{L1: 0.357196298615681, L2: 0.604978911775132, L3: 0.037824789609186, W: 0.046046366595935},
			{L1: 0.357196298615681, L2: 0.037824789609186, L3: 0.604978911775132, W: 0.046046366595935},
			{L1: 0.037824789609186, L2: 0.357196298615681, L3: 0.604978911775132, W: 0.046046366595935},
			{L1: 0.604978911775132, L2: 0.357196298615681, L3: 0.037824789609186, W: 0.046046366595935},
			{L1: 0.604978911775132, L2: 0.037824789609186, L3: 0.357196298615681, W: 0.046046366595935},
			{L1: 0.037824789609186, L2: 0.604978911775132, L3: 0.357196298615681, W: 0.046046366595935},
		},
		{
			{L1: 0.960045625755613, L2: 0.019977187122193, L3: 0.019977187122193, W: 0.005272170280495},
			{L1: 0.019977187122193, L2: 0.960045625755613, L3: 0.019977187122193, W: 0.005272170280495},
			{L1: 0.019977187122193, L2: 0.019977187122193, L3: 0.960045625755613, W: 0.005272170280495},
			{L1: 0.736556464940005, L2: 0.131721767529998, L3: 0.131721767529998, W: 0.044552936679504},
			{L1: 0.131721767529998, L2: 0.736556464940005, L3: 0.131721767529998, W: 0.044552936679504},
			{L1: 0.131721767529998, L2: 0.131721767529998, L3: 0.736556464940005, W: 0.044552936679504},
			{L1: 0.333333333333333, L2: 0.333333333333333, L3: 0.333333333333333, W: 0.083608212215637},
			{L1: 0.485135346793461, L2: 0.485135346793461, L3: 0.029729306413079, W: 0.033815712804198},
			{L1: 0.485135346793461, L2: 0.029729306413079, L3: 0.485135346793461, W: 0.033815712804198},
			{L1: 0.029729306413079, L2: 0.485135346793461, L3: 0.485135346793461, W: 0.033815712804198},
			{L1: 0.107951981846011, L2: 0.867911210117951, L3: 0.024136808036039, W: 0.015710461340183},
			{L1: 0.107951981846011, L2: 0.024136808036039, L3: 0.867911210117951, W: 0.015710461340183},
			{L1: 0.024136808036039, L2: 0.107951981846011, L3: 0.867911210117951, W: 0.015710461340183},
			{L1: 0.867911210117951, L2: 0.107951981846011, L3: 0.024136808036039, W: 0.015710461340183},
			{L1: 0.867911210117951, L2: 0.024136808036039, L3: 0.107951981846011, W: 0.015710461340183},
			{L1: 0.024136808036039, L2: 0.867911210117951, L3: 0.107951981846011, W: 0.015710461340183},
			{L1: 0.270840772921567, L2: 0.700872570380723, L3: 0.028286656697710, W: 0.028205136280616},
			{L1: 0.270840772921567, L2: 0.028286656697710, L3: 0.700872570380723, W: 0.028205136280616},
			{L1: 0.028286656697710, L2: 0.270840772921567, L3: 0.700872570380723, W: 0.028205136280616},
			{L1: 0.700872570380723, L2: 0.270840772921567, L3: 0.028286656697710, W: 0.028205136280616},
			{L1: 0.700872570380723, L2: 0.028286656697710, L3: 0.270840772921567, W: 0.028205136280616},
			{L1: 0.028286656697710, L2: 0.700872570380723, L3: 0.270840772921567, W: 0.028205136280616},
			{L1: 0.316549598844617, L2: 0.536654684206138, L3: 0.146795716949245, W: 0.066995957127830},
			{L1: 0.316549598844617, L2: 0.146795716949245, L3: 0.536654684206138, W: 0.066995957127830},
			{L1: 0.146795716949245, L2: 0.316549598844617, L3: 0.536654684206138, W: 0.066995957127830},
			{L1: 0.536654684206138, L2: 0.316549598844617, L3: 0.146795716949245, W: 0.066995957127830},
			{L1: 0.536654684206138, L2: 0.146795716949245, L3: 0.316549598844617, W: 0.066995957127830},
			{L1: 0.146795716949245, L2: 0.536654684206138, L3: 0.316549598844617, W: 0.066995957127830},
		},
		{
			{L1: 0.957657154441070, L2: 0.021171422779465, L3: 0.021171422779465, W: 0.005639123786910},
			{L1: 0.021171422779465, L2: 0.957657154441070, L3: 0.021171422779465, W: 0.005639123786910},
			{L1: 0.021171422779465, L2: 0.021171422779465, L3: 0.957657154441070, W: 0.005639123786910},
			{L1: 0.798831205208225, L2: 0.100584397395888, L3: 0.100584397395888, W: 0.027148968192278},
			{L1: 0.100584397395888, L2: 0.798831205208225, L3: 0.100584397395888, W: 0.027148968192278},
			{L1: 0.100584397395888, L2: 0.100584397395888, L3: 0.798831205208225, W: 0.027148968192278},
			{L1: 0.457923384576135, L2: 0.271038307711932, L3: 0.271038307711932, W: 0.063100912533359},
			{L1: 0.271038307711932, L2: 0.457923384576135, L3: 0.271038307711932, W: 0.063100912533359},
			{L1: 0.271038307711932, L2: 0.271038307711932, L3: 0.457923384576135, W: 0.063100912533359},
			{L1: 0.440191258403832, L2: 0.440191258403832, L3: 0.119617483192335, W: 0.051752795679899},
			{L1: 0.440191258403832, L2: 0.119617483192335, L3: 0.440191258403832, W: 0.051752795679899},
			{L1: 0.119617483192335, L2: 0.440191258403832, L3: 0.440191258403832, W: 0.051752795679899},
			{L1: 0.101763679498021, L2: 0.879979641427232, L3: 0.018256679074748, W: 0.009866753574646},
			{L1: 0.101763679498021, L2: 0.018256679074748, L3: 0.879979641427232, W: 0.009866753574646},
			{L1: 0.018256679074748, L2: 0.101763679498021, L3: 0.879979641427232, W: 0.009866753574646},
			{L1: 0.879979641427232, L2: 0.101763679498021, L3: 0.018256679074748, W: 0.009866753574646},
			{L1: 0.879979641427232, L2: 0.018256679074748, L3: 0.101763679498021, W: 0.009866753574646},
			{L1: 0.018256679074748, L2: 0.879979641427232, L3: 0.101763679498021, W: 0.009866753574646},
			{L1: 0.394033271669987, L2: 0.582562022863673, L3: 0.023404705466341, W: 0.022008204800147},
			{L1: 0.394033271669987, L2: 0.023404705466341, L3: 0.582562022863673, W: 0.022008204800147},
			{L1: 0.023404705466341, L2: 0.394033271669987, L3: 0.582562022863673, W: 0.022008204800147},
			{L1: 0.582562022863673, L2: 0.394033271669987, L3: 0.023404705466341, W: 0.022008204800147},
			{L1: 0.582562022863673, L2: 0.023404705466341, L3: 0.394033271669987, W: 0.022008204800147},
			{L1: 0.023404705466341, L2: 0.582562022863673, L3: 0.394033271669987, W: 0.022008204800147},
			{L1: 0.226245530909229, L2: 0.751530614542782, L3: 0.022223854547989, W: 0.016644570076736},
			{L1: 0.226245530909229, L2: 0.022223854547989, L3: 0.751530614542782, W: 0.016644570076736},
			{L1: 0.022223854547989, L2: 0.226245530909229, L3: 0.751530614542782, W: 0.016644570076736},
			{L1: 0.751530614542782, L2: 0.226245530909229, L3: 0.022223854547989, W: 0.016644570076736},
			{L1: 0.751530614542782, L2: 0.022223854547989, L3: 0.226245530909229, W: 0.016644570076736},
			{L1: 0.022223854547989, L2: 0.751530614542782, L3: 0.226245530909229, W: 0.016644570076736},
			{L1: 0.635737183263105, L2: 0.249079227621332, L3: 0.115183589115563, W: 0.044326238118914},
			{L1: 0.635737183263105, L2: 0.115183589115563, L3: 0.249079227621332, W: 0.044326238118914},
			{L1: 0.115183589115563, L2: 0.635737183263105, L3: 0.249079227621332, W: 0.044326238118914},
			{L1: 0.249079227621332, L2: 0.635737183263105, L3: 0.115183589115563, W: 0.044326238118914},
			{L1: 0.249079227621332, L2: 0.115183589115563, L3: 0.635737183263105, W: 0.044326238118914},
			{L1: 0.115183589115563, L2: 0.249079227621332, L3: 0.635737183263105, W: 0.044326238118914},
		},
	}
	// var BaryCoords = [][]struct{ L1, L2, L3, W float64 }{
	// BarycentricToRS takes barycentric coords (l1,l2,l3) for the
	// reference triangle with vertices at (-1,-1),(1,-1),(-1,1)
	// and returns the corresponding (r,s) in the [-1,1]Ã—[-1,1] plane.
	//
	// If l1+l2+l3 != 1, it normalizes them first.
	btorsw := func(bcn BarcentricNode) (r, s, w float64) {
		r = -bcn.L1 + bcn.L2 - bcn.L3
		s = -bcn.L1 - bcn.L2 + bcn.L3
		w = bcn.W
		return
	}
	for _, bcn := range BaryCoords[P] {
		r, s, w := btorsw(bcn)
		pts = append(pts, Point{r, s})
		wts = append(wts, w)
	}
	return
}
