package isentropic_vortex

import (
	"math"

	"github.com/notargets/gocfd/utils"
)

type IVortex struct {
	Beta, X0, Y0, Gamma float64
}

func NewIVortex(Beta, X0, Y0, Gamma float64) (iv *IVortex) {
	iv = &IVortex{
		Beta:  Beta,
		X0:    X0,
		Y0:    Y0,
		Gamma: Gamma,
	}
	return
}

func (iv *IVortex) GetState(t, x, y float64) (u, v, rho, p float64) {
	var (
		oo2pi  = 0.5 * (1. / math.Pi)
		r2     = utils.POW(x-t-iv.X0, 2) + utils.POW(y-iv.Y0, 2)
		omr2   = 1. - r2
		bt     = oo2pi * iv.Beta * math.Exp(omr2)
		bt2    = bt * bt
		Gamma  = iv.Gamma
		GM1    = Gamma - 1
		GM1OGM = GM1 / Gamma
	)
	u = 1. - bt*(y-iv.Y0)
	v = bt * (x - iv.X0)
	rho = math.Pow(1.-bt2*GM1OGM/4., 1./GM1)
	p = math.Pow(rho, Gamma)
	return
}

func (iv *IVortex) GetStateC(t, x, y float64) (Rho, RhoU, RhoV, RhoE float64) {
	var (
		ooGM1 = 1. / (iv.Gamma - 1.)
	)
	u, v, rho, p := iv.GetState(t, x, y)
	q := 0.5 * rho * (u*u + v*v)
	Rho, RhoU, RhoV = rho, rho*u, rho*v
	RhoE = p*ooGM1 + q
	return
}

func (iv *IVortex) GetDivergence(t, x, y float64) (div [4]float64) {
	// From a matlab calculation of the divergence of the analytic solution
	// Matlab script is in research/test_cases/isentropic_vortex.m
	var (
		beta   = iv.Beta
		gamma  = iv.Gamma
		x0, y0 = iv.X0, iv.Y0
		exp    = math.Exp
		pow    = math.Pow
	)
	div[0] = (beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0))*(t*2.0-x*2.0+x0*2.0)*(-1.0/2.0))/3.141592653589793 - (beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y*2.0-y0*2.0)*(x-x0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)))/(3.141592653589793*2.0) + ((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0)*(t*4.0-x*4.0+x0*4.0))/(gamma*1.6E+1) + ((beta*beta*beta)*1.0/(3.141592653589793*3.141592653589793*3.141592653589793)*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(y*4.0-y0*4.0)*(x-x0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0))/(gamma*3.2E+1)
	div[1] = (beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*pow(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)), gamma-1.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0)*(t*4.0-x*4.0+x0*4.0)*(-1.0/1.6E+1) - (beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0))/(3.141592653589793*2.0)-(beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y*2.0-y0*2.0)*(y-y0))/(3.141592653589793*2.0))*(x-x0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)))/(3.141592653589793*2.0) + (beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0)*(y-y0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0))*(t*2.0-x*2.0+x0*2.0))/3.141592653589793 + (beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y*2.0-y0*2.0)*((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0)*(x-x0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)))/(3.141592653589793*2.0) - ((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*pow((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0, 2.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0)*(t*4.0-x*4.0+x0*4.0))/(gamma*1.6E+1) - ((beta*beta*beta)*1.0/(3.141592653589793*3.141592653589793*3.141592653589793)*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(y*4.0-y0*4.0)*((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0)*(x-x0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0))/(gamma*3.2E+1)
	div[2] = (beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0))*(-1.0/2.0))/3.141592653589793 + ((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(y*4.0-y0*4.0)*pow(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)), gamma-1.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0))/1.6E+1 - ((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(y*4.0-y0*4.0)*pow(x-x0, 2.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)))/4.0 - (beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0)*(x-x0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0))*(t*2.0-x*2.0+x0*2.0))/(3.141592653589793*2.0) - ((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(x-x0)*(y-y0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0))*(t*2.0-x*2.0+x0*2.0))/4.0 + ((beta*beta*beta*beta)*1.0/(3.141592653589793*3.141592653589793*3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-4.0-pow(t-x+x0, 2.0)*4.0+4.0)*(y*4.0-y0*4.0)*pow(x-x0, 2.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0))/(gamma*6.4E+1) + ((beta*beta*beta)*1.0/(3.141592653589793*3.141592653589793*3.141592653589793)*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0)*(x-x0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0)*(t*4.0-x*4.0+x0*4.0))/(gamma*3.2E+1)
	div[3] = ((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0)*(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, -1.0/(gamma-1.0))*(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0))*(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(x*2.0-x0*2.0))/4.0+((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*pow(x-x0, 2.0)*(t*4.0-x*4.0+x0*4.0))/4.0+(beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0)*(y-y0)*(t*2.0-x*2.0+x0*2.0))/3.141592653589793)*(-1.0/2.0)+((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*pow(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)), gamma-1.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0)*(t*4.0-x*4.0+x0*4.0))/(gamma*1.6E+1-1.6E+1)+((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(pow((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0, 2.0)+((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*pow(x-x0, 2.0))/4.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0)*(t*4.0-x*4.0+x0*4.0))/(gamma*3.2E+1))+((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*pow(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)), gamma-1.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0)*(t*4.0-x*4.0+x0*4.0))/1.6E+1-((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(((pow((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0, 2.0)+((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*pow(x-x0, 2.0))/4.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)))/2.0+pow(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)), gamma)/(gamma-1.0))*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, -1.0/(gamma-1.0)-1.0)*(t*4.0-x*4.0+x0*4.0))/(gamma*1.6E+1)) + (beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(x-x0)*(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, -1.0/(gamma-1.0))*(((((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0))/(3.141592653589793*2.0)-(beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y*2.0-y0*2.0)*(y-y0))/(3.141592653589793*2.0))*((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0)*2.0-((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(y*4.0-y0*4.0)*pow(x-x0, 2.0))/4.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)))/2.0+((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(y*4.0-y0*4.0)*pow(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)), gamma-1.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0))/(gamma*1.6E+1-1.6E+1)+((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(y*4.0-y0*4.0)*(pow((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0, 2.0)+((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*pow(x-x0, 2.0))/4.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0))/(gamma*3.2E+1))+((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(y*4.0-y0*4.0)*pow(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)), gamma-1.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)-1.0))/1.6E+1-((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(((pow((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0, 2.0)+((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*pow(x-x0, 2.0))/4.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)))/2.0+pow(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)), gamma)/(gamma-1.0))*(y*4.0-y0*4.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, -1.0/(gamma-1.0)-1.0))/(gamma*1.6E+1)))/(3.141592653589793*2.0) - (beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(pow(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)), gamma)+(((pow((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0, 2.0)+((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*pow(x-x0, 2.0))/4.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)))/2.0+pow(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)), gamma)/(gamma-1.0))*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, -1.0/(gamma-1.0)))*(y-y0)*(t*2.0-x*2.0+x0*2.0))/(3.141592653589793*2.0) - (beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y*2.0-y0*2.0)*(pow(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)), gamma)+(((pow((beta*exp(-pow(y-y0, 2.0)-pow(t-x+x0, 2.0)+1.0)*(y-y0))/(3.141592653589793*2.0)-1.0, 2.0)+((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*pow(x-x0, 2.0))/4.0)*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)))/2.0+pow(pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, 1.0/(gamma-1.0)), gamma)/(gamma-1.0))*pow(((beta*beta)*1.0/(3.141592653589793*3.141592653589793)*exp(pow(y-y0, 2.0)*-2.0-pow(t-x+x0, 2.0)*2.0+2.0)*(gamma-1.0)*(-1.0/1.6E+1))/gamma+1.0, -1.0/(gamma-1.0)))*(x-x0))/(3.141592653589793*2.0)
	return
}
